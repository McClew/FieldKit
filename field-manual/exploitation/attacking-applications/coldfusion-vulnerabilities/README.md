---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# ColdFusion Vulnerabilities

## Directory Traversal

The attack can be executed by manipulating the input parameters in ColdFusion tags such as `CFFile` and `CFDIRECTORY,` which are used for file and directory operations such as uploading, downloading, and listing files.

{% code title="Code Snippet" %}
```html
<cfdirectory directory="#ExpandPath('uploads/')#" name="fileList">
<cfloop query="fileList">
    <a href="uploads/#fileList.name#">#fileList.name#</a><br>
</cfloop>
```
{% endcode %}

In this code snippet, the ColdFusion `cfdirectory` tag lists the contents of the `uploads` directory, and the `cfloop` tag is used to loop through the query results and display the filenames as clickable links in HTML.

However, the `directory` parameter is not validated correctly, which makes the application vulnerable to a Path Traversal attack. An attacker can exploit this vulnerability by manipulating the `directory` parameter to access files outside the `uploads` directory.

{% code title="HTTP" %}
```http
http://acme.com/index.cfm?directory=../../../etc/&file=passwd
```
{% endcode %}

In this example, the URL attempts to access the `mappings.cfm` file in the `/CFIDE/administrator/settings/` directory of the web application with a specified `en` locale. However, a directory traversal attack can be executed by manipulating the URL's locale parameter, allowing an attacker to read arbitrary files located outside of the intended directory, such as configuration files or system files.

{% code title="Exploited URL" %}
```http
http://www.acme.com/CFIDE/administrator/settings/mappings.cfm?locale=../../../../../etc/passwd
```
{% endcode %}

In this example, the `../` sequences have been used to replace a valid `locale` to traverse the directory structure and access the `passwd` file located in the `/etc/` directory.

See exploits: [cve-2010-2861-path-traversal.md](cve-2010-2861-path-traversal.md "mention")

## Remote Code Execution

```html
<cfset cmd = "#cgi.query_string#">
<cfexecute name="cmd.exe" arguments="/c #cmd#" timeout="5">
```

In the above code, the `cmd` variable is created by concatenating the `cgi.query_string` variable with a command to be executed. This command is then executed using the `cfexecute` function, which runs the Windows `cmd.exe` program with the specified arguments.

This code is vulnerable to an unauthenticated RCE attack because it does not properly validate the `cmd` variable before executing it, nor does it require the user to be authenticated. An attacker could simply pass a malicious command as the `cgi.query_string` variable, and it would be executed by the server.

{% code title="Encoded URL" %}
```http
http://www.acme.com/index.cfm?%3B%20echo%20%22This%20server%20has%20been%20compromised%21%22%20%3E%20C%3A%5Ccompromise.txt
```
{% endcode %}

{% code title="Decoded URL" %}
```
http://www.acme.com/index.cfm?; echo "This server has been compromised!" > C:\compromise.txt
```
{% endcode %}

This URL includes a semicolon (`%3B`) at the beginning of the query string, which can allow for the execution of multiple commands on the server. This could potentially append legitimate functionality with an unintended command.

The included `echo` command prints a message to the console, and is followed by a redirection command to write a file to the `C:` directory with a message indicating that the server has been compromised.

See exploits: [cve-2009-2265-unauthenticated-rce.md](cve-2009-2265-unauthenticated-rce.md "mention")
