---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# LDAP

## LDAP Injection

LDAP injection is an attack that _exploits web applications_ that use LDAP for authentication or storing user information. The attacker can inject malicious code or characters into LDAP queries to alter the application's behaviour, bypass security measures, and access sensitive data stored in the LDAP directory.

### Injection Operators

To test for LDAP injection, you can use input values that contain special characters or operators that can change the query's meaning:

<table><thead><tr><th width="84">Input</th><th>Description</th></tr></thead><tbody><tr><td><code>*</code></td><td>An asterisk <code>*</code> can <code>match any number of characters</code>.</td></tr><tr><td><code>( )</code></td><td>Parentheses <code>( )</code> can <code>group expressions</code>.</td></tr><tr><td><code>|</code></td><td>A vertical bar <code>|</code> can perform <code>logical OR</code>.</td></tr><tr><td><code>&#x26;</code></td><td>An ampersand <code>&#x26;</code> can perform <code>logical AND</code>.</td></tr><tr><td><code>(cn=*)</code></td><td>Input values that try to bypass authentication or authorisation checks by injecting conditions that <code>always evaluate to true</code> can be used. For example, <code>(cn=*)</code> or <code>(objectClass=*)</code> can be used as input values for a username or password fields.</td></tr></tbody></table>

### Example

In the below query, `$username` and `$password` contain the user's login credentials. An attacker could inject the `*` character into the `$username` or `$password` field to modify the LDAP query and bypass authentication.

{% code title="Example LDAP Query using PHP" %}
```php
(&(objectClass=user)(sAMAccountName=$username)(userPassword=$password))
```
{% endcode %}

If an attacker injects the `*` character into the `$username` field, the LDAP query will match any user account with any password. This would allow the attacker to gain access to the application with any password, as shown below:

```php
$username = "*";
$password = "dummy";
(&(objectClass=user)(sAMAccountName=$username)(userPassword=$password))
```

Alternatively, if an attacker injects the `*` character into the `$password` field, the LDAP query would match any user account with any password that contains the injected string. This would allow the attacker to gain access to the application with any username, as shown below:

```php
$username = "dummy";
$password = "*";
(&(objectClass=user)(sAMAccountName=$username)(userPassword=$password))
```





