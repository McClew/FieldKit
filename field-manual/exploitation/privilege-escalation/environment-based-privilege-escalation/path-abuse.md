---
icon: linux
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# Path Abuse

[PATH](http://www.linfo.org/path_env_var.html) is an environment variable that specifies the set of directories where an executable can be located. An account's PATH variable is a set of absolute paths, allowing a user to type a command without specifying the absolute path to the binary.

For example, a user can type `cat /tmp/test.txt` instead of specifying the absolute path `/bin/cat /tmp/test.txt`. We can check the contents of the PATH variable by typing `env | grep PATH` or `echo $PATH`.

{% code title="Command" %}
```bash
echo $PATH
```
{% endcode %}

{% code title="Example Output" %}
```bash
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
```
{% endcode %}

{% hint style="info" %}
Creating a script or program in a directory specified in the PATH will make it executable from any directory on the system.
{% endhint %}

## Overview

Adding `.` to a user's PATH adds their current working directory to the list. For example, if we can modify a user's path, we could replace a common binary such as `ls` with a malicious script such as a reverse shell.

If we add `.` to the path by issuing the command `PATH=.:$PATH` and then `export PATH`, we will be able to run binaries located in our current working directory by just typing the name of the file (i.e. just typing `ls` will call the malicious script named `ls` in the current working directory instead of the binary located at `/bin/ls`).

```shell-session
user@target:~$ PATH=.:${PATH}
user@target:~$ export PATH
user@target:~$ echo $PATH

.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
```

## Test for Vulnerability

To test if the machine is susceptible we modify the path to run a simple `echo` command when the command `ls` is typed.

```shell-session
user@target:~$ touch ls
user@target:~$ echo 'echo "PATH ABUSE!!"' > ls
user@target:~$ chmod +x ls
```

```shell-session
user@target:~$ ls

PATH ABUSE!!
```
