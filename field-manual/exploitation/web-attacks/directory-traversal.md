---
icon: signs-post
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# Directory Traversal

**Directory traversal is a web application security vulnerability that allows an attacker to access files and directories outside the intended scope of a web server.**

This flaw occurs when an application improperly validates user-supplied input, enabling malicious users to manipulate file paths using sequences like `../` to navigate beyond restricted directories.

**Exploiting directory traversal can lead to unauthorised access to sensitive files**, such as configuration files, credentials, or system files.

Leveraging a directory traversal vulnerability for system access is more difficult on Windows than on Linux. This is because:

* You cannot enumerate users by reading files, as you can on Linux.
* Sensitive files are harder to discover without the ability to list directory contents.

***

## Cheatsheet

| Action                                                                                                                                       | Description                                                                                                                                                                |
| -------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p><code>../</code><br><code>....//</code><br><code>..././</code><br><code>....\/</code><br><code>....\/</code><br><code>....////</code></p> | Different variations of directory traversal sequences used to escape the intended directory, intended to bypass weak filtering mechanisms.                                 |
| `echo -n "<string-to-encode>" \| jq -sRr @uri`                                                                                               | Encoding special characters can help bypass input validation or WAF restrictions that block standard traversal sequences.                                                  |
| <p>Unix: <code>/etc/passwd</code><br>Windows: <code>C:\Windows\System32\drivers\etc\hosts</code></p>                                         | Common world-readable files used to verify if directory traversal is working.                                                                                              |
| `/home/<user>/.ssh/id_rsa`                                                                                                                   | On Linux targets, try accessing SSH private keys for users with home directories found on `/etc/passwd`.                                                                   |
| Google, ChatGPT or documentation                                                                                                             | Identify the configuration file locations for applications you’ve already discovered on the target system, as they may contain credentials or other sensitive information. |

{% hint style="info" %}
#### Note

[RFC 17387](https://portal.offsec.com/courses/pen-200-44065/learning/common-web-application-attacks-44643/directory-traversal-44690/identifying-and-exploiting-directory-traversals-44650#fn-local_id_41-7) recommends using slashes in URLs, but Windows-based web applications may only be vulnerable to directory traversal with backslashes. Therefore, always test both forward and backslashes when testing for this vulnerability on Windows.
{% endhint %}

***

## Methodology

{% stepper %}
{% step %}
### Identify Input Vector

The first step is to identify an input vector where we appear to have partial or full control over a file path that the web server interacts with. Common places to look include URL parameters, form inputs, or HTTP headers that reference local files.
{% endstep %}

{% step %}
### Find the Root

Once we have an input vector, the goal is to move up the directory tree until we reach the root of the file system. We do this by adding multiple `../` sequences (and variations to bypass filters) to escape the intended directory.
{% endstep %}

{% step %}
### Confirm Successful Bypass

To confirm that the directory traversal is successful in cases of arbitrary file read, try accessing known world-readable files like `/etc/passwd` on Unix-based systems or `C:\Windows\System32\drivers\etc\hosts` on Windows. If you’re able to read these files, it confirms that you have arbitrary file read access.
{% endstep %}

{% step %}
### Verify Write Vulnerability

If the vulnerability is arbitrary file write, you can’t use the same technique. Instead, try writing to a location where files are publicly accessible, such as a web directory, to verify that the file write vulnerability exists.
{% endstep %}

{% step %}
### Malicious Action

If you successfully gain arbitrary file read access, try reading sensitive files like SSH keys or configuration files from known applications installed on the target system. If you have arbitrary file write access, try overwriting files such as `.ssh/authorized_keys` to gain further control over the system.
{% endstep %}
{% endstepper %}

{% hint style="info" %}
#### Note

We don’t need to be exact with the number of `../`. once we hit the root directory, extra ones won’t make a difference.
{% endhint %}
