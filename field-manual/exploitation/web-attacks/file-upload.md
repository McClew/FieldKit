---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# File Upload

**File Upload Vulnerabilities are security flaws that arise when a web application improperly handles user-uploaded files, allowing attackers to upload malicious files that can compromise the system.**

The primary goal of these attacks is to either inject a malicious file or overwrite an existing one to achieve Remote Code Execution (RCE).

***

## Cheatsheet

TODO

***

## Methodology

{% stepper %}
{% step %}
#### Upload a normal file&#x20;

Before anything else, try uploading a harmless file of the type the application expects.

Look to understand what the application does with the file. Does it store it somewhere and if so, where? Does it process the file in some other way?
{% endstep %}

{% step %}
#### Webshell upload&#x20;

Assuming the file is uploaded somewhere and you know where, try uploading a webshell of the appropriate language (e.g. .php, .asp).

We are going for the low hanging fruit here. If it works, good. But it’s likely that there are mitigations in place to prevent this. The next steps aim to bypass these mitigations.
{% endstep %}

{% step %}
#### Client Side Bypass

It’s possible that there are client side verifications (i.e. JavaScript) preventing the file upload. They are easy to bypass.

Change the webshell extension for the allowed one, upload it, catch the request with Burp Suite or some other web proxy and change the extension before sending the request to the server.
{% endstep %}

{% step %}
#### Whitelist / Blacklist Filter Bypass

If you still can’t upload, there is likely a whitelist / blacklist filter in place.

Fuzz for valid extension combinations using Burp intruder **with** **URL encoding disabled**. The [PayloadAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Extension%20PHP/extensions.lst) repository contains wordlists for file extensions, such as [PHP](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Extension%20PHP/extensions.lst), that can be used here.
{% endstep %}
{% endstepper %}
