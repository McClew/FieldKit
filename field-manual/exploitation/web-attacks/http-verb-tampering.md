---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# HTTP Verb Tampering

HTTP Verb Tampering tests a web applicationâ€™s response when accessing system objects or resources using unusual or disallowed HTTP methods. HTTP methods are frequently referred to as verbs.

While most modern web applications rely solely on `GET` and `POST` requests, the HTTP 1.1 standard defines several other valid request methods. If Web Distributed Authoring and Versioning (WebDAV) extensions are enabled, further methods such as `PROPFIND` or `MOVE` might be accepted.&#x20;

A vulnerability arises when the web server or application mishandles these alternative methods due to insecure configurations or flawed code. Exploiting this misconfiguration can allow attackers to bypass authentication controls or security filters.

Commonly exploited HTTP methods include:

<table><thead><tr><th width="149">Verb</th><th>Description</th></tr></thead><tbody><tr><td><code>HEAD</code></td><td>Identical to a <code>GET</code> request, but only returns the HTTP headers, omitting the response body.</td></tr><tr><td><code>PUT</code></td><td>Designed to write the request payload to a specified location.</td></tr><tr><td><code>DELETE</code></td><td>Designed to delete the resource at a specified location.</td></tr><tr><td><code>OPTIONS</code></td><td>Used to show the different options and HTTP methods accepted by the web server.</td></tr></tbody></table>

If a web server is not securely configured, exploiting methods like `PUT` or `DELETE` can be critical, as they enable file manipulation on the back-end server.

***

## Cheatsheet

The following commands can be used during the enumeration and exploitation of HTTP Verb Tampering vulnerabilities.

### Automated Enumeration (Bash)

This simple script checks common methods (`GET`, `POST`, `PUT`, `TRACE`, `CONNECT`, `OPTIONS`, `PROPFIND`) and filters the HTTP status line from the response.

```bash
#!/bin/bash
for webservmethod in GET POST PUT TRACE CONNECT OPTIONS PROPFIND;
do printf "$webservmethod " ; printf "$webservmethod / HTTP/1.1\nHost: $1\n\n" | nc -q 1 $1 80 | grep "HTTP/1.1"
done
```

### Manual Enumeration (cURL)

Use `cURL` with the `-i` flag (include headers) and `-X` flag (specify method) to probe the target.

<table><thead><tr><th width="241">Purpose</th><th>Command</th></tr></thead><tbody><tr><td>Check accepted methods</td><td><code>curl -i -X OPTIONS http://SERVER_IP:PORT/</code></td></tr><tr><td>Send a HEAD request</td><td><code>curl -i -X HEAD http://SERVER_IP:PORT/admin/restricted_page.php</code></td></tr><tr><td>Send a PUT request</td><td><code>curl -i -X PUT http://SERVER_IP:PORT/resource/upload.php</code></td></tr></tbody></table>

### Manual HTTP Request Format

To craft a request manually (e.g., using `netcat`), follow this structure, ensuring the empty line at the end is included.

```
[METHOD] /[resource_path] HTTP/1.1
host: [www.example.com]
```

***

## Enumeration

The objective of enumeration is to discover which HTTP methods the application accepts for specific resources, outside of the standard `GET` and `POST` requests.

1. **Identify Target Scope:** Determine the list of system objects, URIs, and functionalities within the application (e.g., login pages, file deletion endpoints, input forms).
2. **Use Automation (Recommended):** Use automated tools or the provided Bash script (see Cheatsheet) to rapidly check many different HTTP methods against target pages.
3. **Use the OPTIONS Method:** Send an `OPTIONS` request to the target URI. The response headers will explicitly list the methods currently permitted by the web server (e.g., `Allow: POST,OPTIONS,HEAD,GET`).
4. **Test Unanticipated Methods:** For any methods listed in the `OPTIONS` response that are not required for the normal application function (e.g., `HEAD`, `PUT`, `DELETE`), craft and send custom HTTP requests.

{% hint style="info" %}
The web server should ideally ignore the request or return an error for non-required methods. Any other response indicates a test failure.
{% endhint %}

5. **Look for Errors:** Examine responses for non-standard results (e.g., unexpected status codes or server error pages) that indicate alternative methods are being processed in an unintended manner.

***

## Exploitation Methods

HTTP Verb Tampering vulnerabilities are broadly classified into issues arising from insecure web server configuration (often leading to authentication bypass) or insecure coding (leading to filter bypass).

Bypassing Basic Authentication (Insecure Configuration)

This vulnerability occurs when the web server configuration restricts authentication requirements only to a specified subset of HTTP methods (e.g., just `GET` and `POST`), leaving other valid methods unprotected.

Vulnerable Server Configuration Example (Apache): A system administrator intends to restrict access to a directory using HTTP Basic Authentication:

```
<Limit GET POST>
    Require valid-user
</Limit>
```

Because the restriction only explicitly covers `GET` and `POST`, alternative methods like `HEAD` or `OPTIONS` may be able to bypass the authentication mechanism entirely.



