---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# Linux Network Enumeration

## Basic Network Enumeration

By using `route` or `netstat -rn` we can identify what networks are available and via which interface.

### route

{% code title="Command" %}
```bash
route
```
{% endcode %}

{% code title="Example Output" %}
```bash
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         _gateway        0.0.0.0         UG    0      0        0 ens192
10.129.0.0      0.0.0.0         255.255.0.0     U     0      0        0 ens192
```
{% endcode %}

### netstat

{% code title="Command" %}
```bash
netstat -r
```
{% endcode %}

{% code title="Example Output" %}
```bash
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
0.0.0.0         192.168.1.1     0.0.0.0         UG      0 0         0 eth0
192.168.1.0     0.0.0.0         255.255.255.0   U       0 0         0 eth0
10.10.10.0      192.168.1.10    255.255.255.0   UG      0 0         0 eth0
172.17.0.0      0.0.0.0         255.255.0.0     U       0 0         0 docker0
127.0.0.0       0.0.0.0         255.0.0.0       U       0 0         0 lo
```
{% endcode %}

***

## Checking for Domain Controllers

### resolv.conf

The information in `/etc/resolv.conf` can provide a direct path into an Active Directory (AD) environment by revealing the Internal DNS Server IP Addresses.

The primary information provided by this file is the list of nameservers the host is configured to use. In a domain environment, these are almost always the Domain Controllers or dedicated internal DNS servers managed by the domain.

{% code title="Command" %}
```bash
cat /etc/resolv.conf
```
{% endcode %}

{% code title="Example Output" %}
```bash
# Generated by NetworkManager
search acme-domain.local
nameserver 192.168.10.50
nameserver 192.168.10.51
```
{% endcode %}

### arp Table

The `nameserver` directive directly reveals the IP address of the internal DNS server. In a corporate/domain environment (like one often simulated in CTFs), this DNS server is frequently a Domain Controller

{% code title="Command" %}
```bash
arp -a
```
{% endcode %}

{% code title="Example Output" %}
```bash
Address                  HWtype  HWaddress           Flags Mask  Iface
_gateway                 ether   00:11:22:33:44:55   C     eth0
DC-SERVER.local          ether   00:A0:C9:14:2D:F0   C     eth0
workstation-01           ether   A0:B1:C2:D3:E4:F5   C     eth0
```
{% endcode %}

***

## Host Discovery

### arp Table

We can also check the arp table to see what other hosts the target has been communicating with.

{% code title="Command" %}
```bash
arp -a
```
{% endcode %}

{% code title="Example Output" %}
```bash
Address                  HWtype  HWaddress           Flags Mask  Iface
_gateway                 ether   00:11:22:33:44:55   C     eth0
DC-SERVER.local          ether   00:A0:C9:14:2D:F0   C     eth0
workstation-01           ether   A0:B1:C2:D3:E4:F5   C     eth0
```
{% endcode %}
