---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# Pivoting Reconnaisance

After gaining access to a host, it’s important to perform reconnaissance to assess whether it can serve as a gateway to other systems.

Special attention is given to dual-homed hosts, those with multiple network interfaces connected to separate network segments, as they can potentially enable lateral movement.

If such a host is found, techniques like ping sweeps are used to discover additional targets. When systems don’t respond to ICMP echo requests, more advanced scanning tools like [nmap](../../../toolbox/tooling/information-gathering/network-enumeration/nmap/ "mention") may be required to identify accessible hosts.

***

## Cheetsheet

{% tabs %}
{% tab title="Linux" %}
| Action                                                                                 | Description                                                                                                                                                                       |
| -------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `ifconfig`                                                                             | Displays the current network configuration. Useful for identifying multiple network adapters.                                                                                     |
| `for i in {1..254}; do (ping -c 1 XXX.XXX.XXX.$i \| grep "bytes from" &) ; done`       | <p>Performs a ping sweep from the command line. Modify the IP range as needed.<br><br>Increase the <code>-c</code> value to send more probes if hosts appear to be missed.</p>    |
| `for i in {1..254}; do nc -vz -w 1 XXX.XXX.XXX.$i <port> 2>&1 \| grep succeeded; done` | Performs a port sweep from the command line. Modify the IP range as needed.                                                                                                       |
| `./nmap ...`                                                                           | You can upload a static [nmap](../../../toolbox/tooling/information-gathering/network-enumeration/nmap/ "mention") binary to the compromised host and use it to scan the network. |
| `netstat -r`                                                                           | Displays the system’s routing table. May reveal additional IP addresses or reachable networks.                                                                                    |
{% endtab %}

{% tab title="Windows" %}
| Action                                                                                                                                                                                              | Description                                                                                                                                                            |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `ipconfig`                                                                                                                                                                                          | Displays current network settings. Look for multiple network interfaces.                                                                                               |
| `for /L %i in (1,1,254) do ping XXX.XXX.XXX.%i -n 1 -w 100 \| find "Reply"`                                                                                                                         | <p>Conducts a basic ping sweep.<br><br>Update the IP range as needed. Output formatting may vary. Increase the <code>-n</code> value for more probes if necessary.</p> |
| `1..254 \| ForEach-Object { if (Test-Connection -ComputerName "XXX.XXX.XXX.$_" -Count 1 -Quiet) { Write-Host "XXX.XXX.XXX.$_ is reachable" } else { Write-Host "XXX.XXX.XXX.$_ is unreachable" } }` | <p>Executes a ping sweep using PowerShell.<br><br>Adjust the IP range as required. This can be slow.</p>                                                               |
| `netstat -r`                                                                                                                                                                                        | Displays the system’s routing table. May reveal additional IP addresses or reachable networks.                                                                         |
{% endtab %}
{% endtabs %}

***

## Finding Opportunities to Pivot using ifconfig

```bash
ifconfig 
```

```shell-session
ens192: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.129.202.64  netmask 255.255.0.0  broadcast 10.129.255.255
        inet6 dead:beef::250:56ff:feb9:52eb  prefixlen 64  scopeid 0x0<global>
        inet6 fe80::250:56ff:feb9:52eb  prefixlen 64  scopeid 0x20<link>
        ether 00:50:56:b9:52:eb  txqueuelen 1000  (Ethernet)
        RX packets 35571  bytes 177919049 (177.9 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 10452  bytes 1474767 (1.4 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

ens224: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.16.5.129  netmask 255.255.254.0  broadcast 172.16.5.255
        inet6 fe80::250:56ff:feb9:a9aa  prefixlen 64  scopeid 0x20<link>
        ether 00:50:56:b9:a9:aa  txqueuelen 1000  (Ethernet)
        RX packets 8251  bytes 1125190 (1.1 MB)
        RX errors 0  dropped 40  overruns 0  frame 0
        TX packets 1538  bytes 123584 (123.5 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 270  bytes 22432 (22.4 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 270  bytes 22432 (22.4 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```

In this example, when we use `ifconfig` on the Ubuntu host, we find that this server has multiple NICs:

* One connected to our attack host (`ens192`)
* One communicating to other hosts within a different network (`ens224`)
* The loopback interface (`lo`)

<figure><img src="../../../.gitbook/assets/image (54).png" alt=""><figcaption></figcaption></figure>
