---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
  metadata:
    visible: true
---

# Pivoting Reconnaisance

After gaining access to a host, it’s important to perform reconnaissance to assess whether it can serve as a gateway to other systems.

Special attention is given to dual-homed hosts, those with multiple network interfaces connected to separate network segments, as they can potentially enable lateral movement.

If such a host is found, techniques like ping sweeps are used to discover additional targets. When systems don’t respond to ICMP echo requests, more advanced scanning tools like Nmap may be required to identify accessible hosts.

***

## Cheetsheet

{% tabs %}
{% tab title="Linux" %}
| Action                                                                                 | Description                                                                                                                                                                    |
| -------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `ifconfig`                                                                             | Displays the current network configuration. Useful for identifying multiple network adapters.                                                                                  |
| `for i in {1..254}; do (ping -c 1 XXX.XXX.XXX.$i \| grep "bytes from" &) ; done`       | <p>Performs a ping sweep from the command line. Modify the IP range as needed.<br><br>Increase the <code>-c</code> value to send more probes if hosts appear to be missed.</p> |
| `for i in {1..254}; do nc -vz -w 1 XXX.XXX.XXX.$i <port> 2>&1 \| grep succeeded; done` | Performs a port sweep from the command line. Modify the IP range as needed.                                                                                                    |
| `./nmap ...`                                                                           | You can upload a static Nmap binary to the compromised host and use it to scan the network.                                                                                    |
| `netstat -r`                                                                           | Displays the system’s routing table. May reveal additional IP addresses or reachable networks.                                                                                 |
{% endtab %}

{% tab title="Windows" %}
| Action                                                                                                                                                                                              | Description                                                                                                                                                            |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `ipconfig`                                                                                                                                                                                          | Displays current network settings. Look for multiple network interfaces.                                                                                               |
| `for /L %i in (1,1,254) do ping XXX.XXX.XXX.%i -n 1 -w 100 \| find "Reply"`                                                                                                                         | <p>Conducts a basic ping sweep.<br><br>Update the IP range as needed. Output formatting may vary. Increase the <code>-n</code> value for more probes if necessary.</p> |
| `1..254 \| ForEach-Object { if (Test-Connection -ComputerName "XXX.XXX.XXX.$_" -Count 1 -Quiet) { Write-Host "XXX.XXX.XXX.$_ is reachable" } else { Write-Host "XXX.XXX.XXX.$_ is unreachable" } }` | <p>Executes a ping sweep using PowerShell.<br><br>Adjust the IP range as required. This can be slow.</p>                                                               |
| `netstat -r`                                                                                                                                                                                        | Displays the system’s routing table. May reveal additional IP addresses or reachable networks.                                                                         |
{% endtab %}
{% endtabs %}
