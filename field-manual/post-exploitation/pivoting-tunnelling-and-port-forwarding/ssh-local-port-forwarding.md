# SSH Local Port Forwarding

Local port forwarding allows you to forward a port on your local machine to a port on a remote machine, through an SSH server. This is useful for accessing a service on a private network from your local machine, where the SSH server acts as an intermediary.

<figure><img src="../../../.gitbook/assets/11.webp" alt=""><figcaption></figcaption></figure>

> **Scenario:** You want to access a web server running on `192.168.1.100` on port `80` (an internal host), but you only have SSH access to a jump host (`jumpbox.example.com`) that can reach `192.168.1.100`.

***

## Basic Command

```bash
ssh -L 8080:192.168.1.100:80 user@jumpbox.example.com
```

### Explanation

* `-L 8080`: Specifies that a local port `8080` on your machine will be used.
* `192.168.1.100`: The destination IP address (the internal web server).
* `80`: The destination port on `192.168.1.100` (the web server's port).
* `user@jumpbox.example.com`: The SSH credentials and address of the jump host.

After executing this command, you can open your web browser and navigate to `http://localhost:8080`. Your traffic will be forwarded through `jumpbox.example.com` to `192.168.1.100:80`.

***

## Forwarding Multiple Ports

```bash
ssh -L 1234:localhost:3306 -L 8080:localhost:80 ubuntu@10.129.202.64
```

### Explanation

* `-L 1234:localhost:3306`: Specifies the first local port forward. Traffic from your local machine's port `1234` will be forwarded to port `3306` on the remote host (`10.129.202.64`), addressing its `localhost`. This is often used for a database service (e.g., MySQL).
* `-L 8080:localhost:80`: Specifies the second local port forward. Traffic from your local machine's port `8080` will be forwarded to port `80` on the remote host (`10.129.202.64`), again addressing its `localhost`. This is typically used for a web server.
* `ubuntu@10.129.202.64`: The SSH credentials (`ubuntu` user) and address of the SSH server (the jump host) through which the connections will be tunnelled.

After executing this command, you can access the remote MySQL service by connecting to `localhost:1234` on your machine, and the remote web server by navigating to `http://localhost:8080` in your web browser. Both connections are securely forwarded through the SSH session to `10.129.202.64`.

***

## Confirming Port Forward

We can use Netstat or Nmap to query our local host on 1234 port to verify whether the MySQL service was forwarded.

### Netstat

```bash
netstat -antp | grep 1234
```

```shell-session
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
tcp        0      0 127.0.0.1:1234          0.0.0.0:*               LISTEN      4034/ssh            
tcp6       0      0 ::1:1234                :::*                    LISTEN      4034/ssh     
```

### Nmap

```bash
nmap -v -sV -p1234 localhost
```

```
<SNIP>

PORT     STATE SERVICE VERSION
1234/tcp open  mysql   MySQL 8.0.28-0ubuntu0.20.04.3

<SNIP>
```

***

